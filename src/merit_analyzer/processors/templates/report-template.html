<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merit Test Failure Analysis Report</title>
    <style>

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg: hsl(215, 28%, 6%);
            --panel: hsl(217, 29%, 9%);
            --elevated: hsl(218, 30%, 12%);
            --border: hsl(217, 20%, 18%);
            --text: hsl(210, 40%, 96%);
            --text-muted: hsl(210, 12%, 64%);
            --accent: hsl(221, 83%, 72%);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            font-feature-settings: "rlig" 1, "calt" 1;
            padding: 24px;
        }
        
        .container {
            max-width: 1280px;
            margin: 0 auto;
        }
        
        .back-button {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 14px;
            margin-bottom: 24px;
        }
        
        .back-button:hover {
            color: var(--text);
            background: var(--elevated);
        }
        
        .header-card {
            background: linear-gradient(135deg, var(--panel) 0%, var(--elevated) 100%);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .header-left {
            flex: 1;
        }
        
        .header-title-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .icon-box {
            padding: 12px;
            background: rgba(124, 158, 255, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(124, 158, 255, 0.3);
        }
        
        .icon-box svg {
            width: 24px;
            height: 24px;
            color: var(--accent);
        }
        
        h1 {
            font-size: 30px;
            font-weight: 700;
            color: var(--text);
            margin: 0;
        }
        
        .header-badges {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }
        
        .badge {
            padding: 6px 12px;
            background: var(--elevated);
            border-radius: 999px;
            font-size: 14px;
            color: var(--text-muted);
            border: 1px solid var(--border);
        }
        
        .report-id {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: monospace;
            font-size: 12px;
            background: var(--elevated);
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .copy-btn {
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
        }
        
        .copy-btn:hover {
            color: var(--text);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .summary-card {
            border-radius: 12px;
            padding: 20px;
            border: 1px solid;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .summary-card.critical {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.05) 100%);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .summary-card.high {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1) 0%, rgba(234, 88, 12, 0.05) 100%);
            border-color: rgba(249, 115, 22, 0.3);
        }
        
        .summary-card.fixes {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .summary-card.tests {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(147, 51, 234, 0.05) 100%);
            border-color: rgba(168, 85, 247, 0.3);
        }
        
        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .summary-icon {
            padding: 8px;
            border-radius: 8px;
            border: 1px solid;
        }
        
        .summary-card.critical .summary-icon {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .summary-card.high .summary-icon {
            background: rgba(249, 115, 22, 0.2);
            border-color: rgba(249, 115, 22, 0.3);
        }
        
        .summary-card.fixes .summary-icon {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .summary-card.tests .summary-icon {
            background: rgba(168, 85, 247, 0.2);
            border-color: rgba(168, 85, 247, 0.3);
        }
        
        .summary-icon svg {
            width: 20px;
            height: 20px;
        }
        
        .summary-card.critical .summary-icon svg {
            color: rgb(248, 113, 113);
        }
        
        .summary-card.high .summary-icon svg {
            color: rgb(251, 146, 60);
        }
        
        .summary-card.fixes .summary-icon svg {
            color: rgb(96, 165, 250);
        }
        
        .summary-card.tests .summary-icon svg {
            color: rgb(196, 181, 253);
        }
        
        .summary-badge {
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 999px;
            border: 1px solid;
        }
        
        .summary-card.critical .summary-badge {
            background: rgba(239, 68, 68, 0.2);
            color: rgb(248, 113, 113);
            border-color: rgba(239, 68, 68, 0.4);
        }
        
        .summary-card.high .summary-badge {
            background: rgba(249, 115, 22, 0.2);
            color: rgb(251, 146, 60);
            border-color: rgba(249, 115, 22, 0.4);
        }
        
        .summary-card.fixes .summary-badge {
            background: rgba(59, 130, 246, 0.2);
            color: rgb(96, 165, 250);
            border-color: rgba(59, 130, 246, 0.4);
        }
        
        .summary-card.tests .summary-badge {
            background: rgba(168, 85, 247, 0.2);
            color: rgb(196, 181, 253);
            border-color: rgba(168, 85, 247, 0.4);
        }
        
        .summary-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 4px;
        }
        
        .summary-label {
            font-size: 14px;
            color: var(--text-muted);
        }
        
        .clusters {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .cluster-card {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 8px;
            transition: all 0.2s;
        }
        
        .cluster-card:hover {
            border-color: rgba(124, 158, 255, 0.3);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .cluster-card.expanded {
            border-left-width: 4px;
        }
        
        .cluster-card.expanded.critical {
            border-left-color: rgb(239, 68, 68);
        }
        
        .cluster-card.expanded.high {
            border-left-color: rgb(249, 115, 22);
        }
        
        .cluster-card.expanded.medium {
            border-left-color: rgb(234, 179, 8);
        }
        
        .cluster-card.expanded.low {
            border-left-color: rgb(59, 130, 246);
        }
        
        .cluster-header {
            padding: 24px;
            cursor: pointer;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
            display: flex;
            align-items: flex-start;
            gap: 16px;
        }
        
        .cluster-header:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .chevron {
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .chevron svg {
            width: 20px;
            height: 20px;
            color: var(--text-muted);
        }
        
        .cluster-info {
            flex: 1;
            min-width: 0;
        }
        
        .cluster-title-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        
        .cluster-number {
            font-size: 14px;
            font-family: monospace;
            color: var(--text-muted);
        }
        
        .cluster-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--text);
        }
        
        .severity-badge {
            font-size: 12px;
            font-weight: 500;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid;
        }
        
        .severity-badge.critical {
            background: rgba(239, 68, 68, 0.1);
            color: rgb(248, 113, 113);
            border-color: rgba(239, 68, 68, 0.2);
        }
        
        .severity-badge.high {
            background: rgba(249, 115, 22, 0.1);
            color: rgb(251, 146, 60);
            border-color: rgba(249, 115, 22, 0.2);
        }
        
        .severity-badge.medium {
            background: rgba(234, 179, 8, 0.1);
            color: rgb(250, 204, 21);
            border-color: rgba(234, 179, 8, 0.2);
        }
        
        .severity-badge.low {
            background: rgba(59, 130, 246, 0.1);
            color: rgb(96, 165, 250);
            border-color: rgba(59, 130, 246, 0.2);
        }
        
        .cluster-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
            font-size: 14px;
            color: var(--text-muted);
        }
        
        .cluster-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .cluster-meta-item svg {
            width: 14px;
            height: 14px;
        }
        
        .cluster-content {
            padding: 0 24px 24px 24px;
            display: none;
        }
        
        .cluster-content.expanded {
            display: block;
        }
        
        .section {
            margin-bottom: 24px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .section-icon {
            padding: 6px;
            border-radius: 4px;
            border: 1px solid;
        }
        
        .section-icon.alert {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .section-icon.alert svg {
            width: 16px;
            height: 16px;
            color: rgb(248, 113, 113);
        }
        
        .section-icon.code {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .section-icon.code svg {
            width: 16px;
            height: 16px;
            color: rgb(96, 165, 250);
        }
        
        .section-icon.traceback {
            background: rgba(168, 85, 247, 0.2);
            border-color: rgba(168, 85, 247, 0.3);
        }
        
        .section-icon.traceback svg {
            width: 16px;
            height: 16px;
            color: rgb(196, 181, 253);
        }
        
        .section-icon.fixes {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.3);
        }
        
        .section-icon.fixes svg {
            width: 16px;
            height: 16px;
            color: rgb(74, 222, 128);
        }
        
        .section-icon.tests {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .section-icon.tests svg {
            width: 16px;
            height: 16px;
            color: rgb(248, 113, 113);
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .problematic-behavior {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
        }
        
        .problematic-behavior p {
            color: var(--text);
            line-height: 1.6;
        }
        
        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 12px;
        }
        
        .component-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(37, 99, 235, 0.05) 100%);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 16px;
            transition: border-color 0.2s;
        }
        
        .component-card:hover {
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .component-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .component-header svg {
            width: 16px;
            height: 16px;
            color: rgb(96, 165, 250);
        }
        
        .component-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            font-family: monospace;
        }
        
        .component-file {
            font-size: 12px;
            color: var(--text-muted);
            font-family: monospace;
            margin-bottom: 8px;
        }
        
        .component-type {
            font-size: 12px;
            padding: 4px 8px;
            background: rgba(59, 130, 246, 0.2);
            color: rgb(96, 165, 250);
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 4px;
            display: inline-block;
        }
        
        .traceback-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .traceback-frame {
            background: linear-gradient(to right, rgba(168, 85, 247, 0.1) 0%, rgba(147, 51, 234, 0.05) 100%);
            border-left: 4px solid rgba(168, 85, 247, 0.5);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-left-width: 4px;
            border-radius: 8px;
            padding: 16px;
            transition: border-color 0.2s;
        }
        
        .traceback-frame:hover {
            border-color: rgba(168, 85, 247, 0.5);
        }
        
        .traceback-frame-label {
            font-size: 12px;
            font-weight: 700;
            color: rgb(196, 181, 253);
            background: rgba(168, 85, 247, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid rgba(168, 85, 247, 0.4);
            display: inline-block;
            margin-bottom: 8px;
        }
        
        .traceback-description {
            font-size: 14px;
            color: var(--text);
            line-height: 1.6;
        }
        
        .fixes-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .fix-card {
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.2s;
        }
        
        .fix-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .fix-card.expanded {
            border-color: rgba(124, 158, 255, 0.5);
            background: linear-gradient(135deg, rgba(124, 158, 255, 0.1) 0%, rgba(124, 158, 255, 0.05) 100%);
        }
        
        .fix-header {
            padding: 16px;
            cursor: pointer;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
            display: flex;
            align-items: flex-start;
            gap: 16px;
        }
        
        .fix-header:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        
        .fix-icon-box {
            border-radius: 8px;
            padding: 12px;
            border: 1px solid;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .fix-icon-box.prompt {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .fix-icon-box.prompt svg {
            width: 16px;
            height: 16px;
            color: rgb(96, 165, 250);
        }
        
        .fix-icon-box.code {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.3);
        }
        
        .fix-icon-box.code svg {
            width: 16px;
            height: 16px;
            color: rgb(74, 222, 128);
        }
        
        .fix-icon-box.config {
            background: rgba(168, 85, 247, 0.2);
            border-color: rgba(168, 85, 247, 0.3);
        }
        
        .fix-icon-box.config svg {
            width: 16px;
            height: 16px;
            color: rgb(196, 181, 253);
        }
        
        .fix-icon-box.design {
            background: rgba(234, 179, 8, 0.2);
            border-color: rgba(234, 179, 8, 0.3);
        }
        
        .fix-icon-box.design svg {
            width: 16px;
            height: 16px;
            color: rgb(250, 204, 21);
        }
        
        .fix-info {
            flex: 1;
        }
        
        .fix-title-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        
        .fix-type-badge {
            font-size: 12px;
            font-weight: 700;
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .fix-type-badge.prompt {
            background: rgba(59, 130, 246, 0.2);
            color: rgb(96, 165, 250);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .fix-type-badge.code {
            background: rgba(34, 197, 94, 0.2);
            color: rgb(74, 222, 128);
            border-color: rgba(34, 197, 94, 0.3);
        }
        
        .fix-type-badge.config {
            background: rgba(168, 85, 247, 0.2);
            color: rgb(196, 181, 253);
            border-color: rgba(168, 85, 247, 0.3);
        }
        
        .fix-type-badge.design {
            background: rgba(234, 179, 8, 0.2);
            color: rgb(250, 204, 21);
            border-color: rgba(234, 179, 8, 0.3);
        }
        
        .fix-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text);
        }
        
        .fix-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 8px;
        }
        
        .fix-meta svg {
            width: 12px;
            height: 12px;
        }
        
        .fix-meta-file {
            font-family: monospace;
        }
        
        .fix-lines {
            padding: 4px 8px;
            background: var(--elevated);
            border-radius: 4px;
            border: 1px solid var(--border);
        }
        
        .fix-chevron {
            padding: 8px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--elevated);
        }
        
        .fix-chevron.expanded {
            background: rgba(124, 158, 255, 0.2);
            border-color: rgba(124, 158, 255, 0.3);
        }
        
        .fix-chevron svg {
            width: 16px;
            height: 16px;
            color: var(--text-muted);
        }
        
        .fix-description {
            padding: 16px;
            border-top: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.02);
            display: none;
        }
        
        .fix-description.expanded {
            display: block;
        }
        
        .fix-description p {
            font-size: 14px;
            color: var(--text);
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .tests-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .test-card {
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.05) 100%);
            transition: border-color 0.2s;
        }
        
        .test-card:hover {
            border-color: rgba(239, 68, 68, 0.5);
        }
        
        .test-header {
            padding: 16px;
            cursor: pointer;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .test-header:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        
        .test-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .test-icon {
            padding: 8px;
            background: rgba(239, 68, 68, 0.2);
            border-radius: 8px;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .test-icon svg {
            width: 16px;
            height: 16px;
            color: rgb(248, 113, 113);
        }
        
        .test-title-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }
        
        .test-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
        }
        
        .test-failed-badge {
            font-size: 12px;
            padding: 4px 8px;
            background: rgba(239, 68, 68, 0.2);
            color: rgb(248, 113, 113);
            border: 1px solid rgba(239, 68, 68, 0.4);
            border-radius: 4px;
        }
        
        .test-error-count {
            font-size: 12px;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .test-error-count svg {
            width: 12px;
            height: 12px;
        }
        
        .test-chevron {
            padding: 8px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--elevated);
        }
        
        .test-chevron.expanded {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.3);
        }
        
        .test-chevron svg {
            width: 16px;
            height: 16px;
            color: var(--text-muted);
        }
        
        .test-content {
            padding: 16px;
            border-top: 1px solid rgba(239, 68, 68, 0.3);
            background: rgba(255, 255, 255, 0.02);
            display: none;
            flex-direction: column;
            gap: 16px;
        }
        
        .test-content.expanded {
            display: flex;
        }
        
        .test-section {
            border-radius: 8px;
            padding: 16px;
        }
        
        .test-section.input {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        .test-section.output {
            background: rgba(234, 179, 8, 0.1);
            border: 1px solid rgba(234, 179, 8, 0.3);
        }
        
        .test-section-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .test-section-icon {
            padding: 4px;
            border-radius: 4px;
            border: 1px solid;
        }
        
        .test-section.input .test-section-icon {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .test-section.input .test-section-icon svg {
            width: 12px;
            height: 12px;
            color: rgb(96, 165, 250);
        }
        
        .test-section.output .test-section-icon {
            background: rgba(234, 179, 8, 0.2);
            border-color: rgba(234, 179, 8, 0.3);
        }
        
        .test-section.output .test-section-icon svg {
            width: 12px;
            height: 12px;
            color: rgb(250, 204, 21);
        }
        
        .test-section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .test-section pre {
            font-size: 12px;
            background: rgba(255, 255, 255, 0.02);
            padding: 12px;
            border-radius: 4px;
            border: 1px solid var(--border);
            overflow-x: auto;
            color: var(--text);
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .test-errors {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .test-error-item {
            background: linear-gradient(to right, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.1) 100%);
            border-left: 4px solid rgb(239, 68, 68);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-left-width: 4px;
            border-radius: 8px;
            padding: 12px;
        }
        
        .test-error-item p {
            font-size: 14px;
            color: rgb(252, 165, 165);
            line-height: 1.6;
        }
        
        .test-errors-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .test-errors-icon {
            padding: 4px;
            background: rgba(239, 68, 68, 0.2);
            border-radius: 4px;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .test-errors-icon svg {
            width: 12px;
            height: 12px;
            color: rgb(248, 113, 113);
        }
        
        .test-errors-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        button {
            font-family: inherit;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }
    
    </style>
</head>
<body>
    <div class="container">
        <div class="header-card">
            <div class="header-content">
                <div class="header-left">
                    <div class="header-title-row">
                        <div class="icon-box">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="m10 13-2 2 2 2"/><path d="m14 17 2-2-2-2"/></svg>
                        </div>
                        <h1>Merit Test Failure Analysis Report</h1>
                    </div>
                    <div class="header-badges">
                        <span class="badge">üìÑ <span id="sourceFile">testing/test_data.csv</span></span>
                        <span class="badge">üîç <span id="errorGroupsCount">‚Äî</span> Error Groups</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="summary-grid">
            <div class="summary-card critical">
                <div class="summary-header">
                    <div class="summary-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2l8 14a2 2 0 0 0 2 2h9.73a2 2 0 0 0 2-2z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
                    </div>
                    <span class="summary-badge">Critical</span>
                </div>
                <div class="summary-value" id="criticalCount">‚Äî</div>
                <div class="summary-label">Critical Issues</div>
            </div>
            
            <div class="summary-card high">
                <div class="summary-header">
                    <div class="summary-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
                    </div>
                    <span class="summary-badge">High</span>
                </div>
                <div class="summary-value" id="highCount">‚Äî</div>
                <div class="summary-label">High Priority</div>
            </div>
            
            <div class="summary-card fixes">
                <div class="summary-header">
                    <div class="summary-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
                    </div>
                    <span class="summary-badge">Fixes</span>
                </div>
                <div class="summary-value" id="fixesCount">‚Äî</div>
                <div class="summary-label">Recommended Fixes</div>
            </div>
            
            <div class="summary-card tests">
                <div class="summary-header">
                    <div class="summary-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5s-2.5-1.1-2.5-2.5V2"/><path d="M8.5 2h7"/><path d="M14.5 16h-5"/></svg>
                    </div>
                    <span class="summary-badge">Tests</span>
                </div>
                <div class="summary-value" id="testsCount">‚Äî</div>
                <div class="summary-label">Failed Tests</div>
            </div>
        </div>
        
        <div class="clusters" id="clustersContainer">
            <!-- Clusters will be rendered here by JavaScript -->
        </div>
    </div>
    
    <script type="application/json" id="report-data">
{}
</script>
<script>
        // Load report data from embedded JSON
        const reportData = JSON.parse(document.getElementById('report-data').textContent);
        
        // Helper functions
        function getClusterSeverity(cluster) {
            const hasFabrication = cluster.name.toLowerCase().includes('fabricat') || cluster.name.toLowerCase().includes('hallucinat');
            const hasDataLoss = cluster.name.toLowerCase().includes('truncat') || cluster.name.toLowerCase().includes('loses');
            const testCount = cluster.relatedFailedTests.length;
            const fixCount = cluster.recommendedFixes.length;
            
            if (hasFabrication) return 'critical';
            if (hasDataLoss || testCount > 5) return 'high';
            if (fixCount > 2 || testCount > 0) return 'medium';
            return 'low';
        }
        
        function getFixTypeIcon(type) {
            const icons = {
                prompt: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
                code: `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>`,
                config: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></svg>`,
                design: `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>`
            };
            return icons[type] || icons.prompt;
        }
        
        function getFixTypeClass(type) {
            return type;
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // State management
        let expandedClusters = new Set();
        let expandedFixes = new Set();
        let expandedTests = new Set();
        
        function toggleCluster(clusterId) {
            if (expandedClusters.has(clusterId)) {
                expandedClusters.delete(clusterId);
            } else {
                expandedClusters.add(clusterId);
            }
            renderClusters();
        }
        
        function toggleFix(fixId) {
            if (expandedFixes.has(fixId)) {
                expandedFixes.delete(fixId);
            } else {
                expandedFixes.add(fixId);
            }
            renderClusters();
        }
        
        function toggleTest(testId) {
            if (expandedTests.has(testId)) {
                expandedTests.delete(testId);
            } else {
                expandedTests.add(testId);
            }
            renderClusters();
        }
        
        // Render functions
        function renderClusters() {
            const container = document.getElementById('clustersContainer');
            if (!container || !reportData) return;
            
            container.innerHTML = reportData.clusters.map((cluster, index) => {
                const clusterNumber = index + 1;
                const severity = getClusterSeverity(cluster);
                const isExpanded = expandedClusters.has(cluster.id);
                
                return `<div class="cluster-card ${isExpanded ? 'expanded ' + severity : ''}">
                    <button class="cluster-header" onclick="toggleCluster('${cluster.id}')">
                        <div class="chevron">
                            ${isExpanded ? '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>'}
                        </div>
                        <div class="cluster-info">
                            <div class="cluster-title-row">
                                <span class="cluster-number">#${clusterNumber}</span>
                                <span class="cluster-name">${escapeHtml(cluster.name)}</span>
                                <span class="severity-badge ${severity}">${severity.toUpperCase()}</span>
                            </div>
                            <div class="cluster-meta">
                                <span class="cluster-meta-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                                    ${cluster.involvedComponents.length} component${cluster.involvedComponents.length !== 1 ? 's' : ''}
                                </span>
                                <span class="cluster-meta-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
                                    ${cluster.recommendedFixes.length} fix${cluster.recommendedFixes.length !== 1 ? 'es' : ''}
                                </span>
                                <span class="cluster-meta-item">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5s-2.5-1.1-2.5-2.5V2"/><path d="M8.5 2h7"/><path d="M14.5 16h-5"/></svg>
                                    ${cluster.relatedFailedTests.length} test${cluster.relatedFailedTests.length !== 1 ? 's' : ''}
                                </span>
                            </div>
                        </div>
                    </button>
                    ${isExpanded ? renderClusterContent(cluster, severity) : ''}
                </div>`;
            }).join('');
        }
        
        function renderClusterContent(cluster, severity) {
            const severityColors = {
                critical: { icon: 'rgb(248, 113, 113)' },
                high: { icon: 'rgb(251, 146, 60)' },
                medium: { icon: 'rgb(250, 204, 21)' },
                low: { icon: 'rgb(96, 165, 250)' }
            };
            const iconColor = severityColors[severity]?.icon || 'rgb(248, 113, 113)';
            
            return `
                <div class="cluster-content expanded">
                    <div class="section">
                        <div class="problematic-behavior">
                            <div class="section-header">
                                <div class="section-icon alert" style="color: ${iconColor};">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2l8 14a2 2 0 0 0 2 2h9.73a2 2 0 0 0 2-2z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
                                </div>
                                <h3 class="section-title">Problematic Behavior</h3>
                            </div>
                            <p>${escapeHtml(cluster.problematicBehavior)}</p>
                        </div>
                    </div>
                    ${cluster.involvedComponents.length > 0 ? renderComponents(cluster.involvedComponents) : ''}
                    ${cluster.traceback.length > 0 ? renderTraceback(cluster.traceback) : ''}
                    ${cluster.recommendedFixes.length > 0 ? renderFixes(cluster.id, cluster.recommendedFixes) : ''}
                    ${cluster.relatedFailedTests.length > 0 ? renderTests(cluster.id, cluster.relatedFailedTests) : ''}
                </div>
            `;
        }
        
        function renderComponents(components) {
            return `
                <div class="section">
                    <div class="section-header">
                        <div class="section-icon code">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                        </div>
                        <h3 class="section-title">Involved Components (${components.length})</h3>
                    </div>
                    <div class="components-grid">
                        ${components.map(comp => `
                            <div class="component-card">
                                <div class="component-header">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="m10 13-2 2 2 2"/><path d="m14 17 2-2-2-2"/></svg>
                                    <div class="component-name">${escapeHtml(comp.name)}</div>
                                </div>
                                <div class="component-file">${escapeHtml(comp.file)}</div>
                                <div class="component-type">${escapeHtml(comp.type.replace('ComponentType.', ''))}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        function renderTraceback(traceback) {
            return `
                <div class="section">
                    <div class="section-header">
                        <div class="section-icon traceback">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></svg>
                        </div>
                        <h3 class="section-title">Traceback (${traceback.length} frames)</h3>
                    </div>
                    <div class="traceback-list">
                        ${traceback.map(frame => `
                            <div class="traceback-frame">
                                <div class="traceback-frame-label">${escapeHtml(frame.frame)}</div>
                                <div class="traceback-description">${escapeHtml(frame.description)}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        function renderFixes(clusterId, fixes) {
            return `
                <div class="section">
                    <div class="section-header">
                        <div class="section-icon fixes">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
                        </div>
                        <h3 class="section-title">Recommended Fixes (${fixes.length})</h3>
                    </div>
                    <div class="fixes-list">
                        ${fixes.map((fix, idx) => {
                            const fixId = `${clusterId}-fix-${idx}`;
                            const isExpanded = expandedFixes.has(fixId);
                            const fixClass = getFixTypeClass(fix.type);
                            return `
                                <div class="fix-card ${isExpanded ? 'expanded' : ''}">
                                    <button class="fix-header" onclick="toggleFix('${fixId}')">
                                        <div class="fix-icon-box ${fixClass}">
                                            ${getFixTypeIcon(fix.type)}
                                        </div>
                                        <div class="fix-info">
                                            <div class="fix-title-row">
                                                <span class="fix-type-badge ${fixClass}">${fix.type.toUpperCase()}</span>
                                                <span class="fix-title">${escapeHtml(fix.title)}</span>
                                            </div>
                                            <div class="fix-meta">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="m10 13-2 2 2 2"/><path d="m14 17 2-2-2-2"/></svg>
                                                <span class="fix-meta-file">${escapeHtml(fix.file)}</span>
                                                ${fix.lines ? `<span>‚Ä¢</span><span class="fix-lines">Lines ${escapeHtml(fix.lines)}</span>` : ''}
                                            </div>
                                        </div>
                                        <div class="fix-chevron ${isExpanded ? 'expanded' : ''}">
                                            ${isExpanded ? '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>'}
                                        </div>
                                    </button>
                                    ${isExpanded ? `<div class="fix-description expanded"><p>${escapeHtml(fix.description)}</p></div>` : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }
        
        function renderTests(clusterId, tests) {
            return `
                <div class="section">
                    <div class="section-header">
                        <div class="section-icon tests">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5s-2.5-1.1-2.5-2.5V2"/><path d="M8.5 2h7"/><path d="M14.5 16h-5"/></svg>
                        </div>
                        <h3 class="section-title">Related Failed Tests (${tests.length})</h3>
                    </div>
                    <div class="tests-list">
                        ${tests.map((test, idx) => {
                            const testId = `${clusterId}-test-${idx}`;
                            const isExpanded = expandedTests.has(testId);
                            return `
                                <div class="test-card">
                                    <button class="test-header" onclick="toggleTest('${testId}')">
                                        <div class="test-info">
                                            <div class="test-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
                                            </div>
                                            <div>
                                                <div class="test-title-row">
                                                    <span class="test-title">Test Case #${idx + 1}</span>
                                                    <span class="test-failed-badge">FAILED</span>
                                                </div>
                                                <div class="test-error-count">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2l8 14a2 2 0 0 0 2 2h9.73a2 2 0 0 0 2-2z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
                                                    ${test.assertions_result.errors.length} error${test.assertions_result.errors.length !== 1 ? 's' : ''}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="test-chevron ${isExpanded ? 'expanded' : ''}">
                                            ${isExpanded ? '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>'}
                                        </div>
                                    </button>
                                    ${isExpanded ? renderTestContent(test) : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }
        
        function renderTestContent(test) {
            const caseInput = typeof test.case_data.case_input === 'string' 
                ? test.case_data.case_input 
                : JSON.stringify(test.case_data.case_input, null, 2);
            const output = JSON.stringify(test.output_for_assertions, null, 2);
            
            return `
                <div class="test-content expanded">
                    <div class="test-section input">
                        <div class="test-section-header">
                            <div class="test-section-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                            </div>
                            <div class="test-section-title">Input</div>
                        </div>
                        <pre>${escapeHtml(caseInput)}</pre>
                    </div>
                    <div class="test-section output">
                        <div class="test-section-header">
                            <div class="test-section-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                            </div>
                            <div class="test-section-title">Output</div>
                        </div>
                        <pre>${escapeHtml(output)}</pre>
                    </div>
                    <div>
                        <div class="test-errors-header">
                            <div class="test-errors-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2l8 14a2 2 0 0 0 2 2h9.73a2 2 0 0 0 2-2z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></svg>
                            </div>
                            <div class="test-errors-title">Errors (${test.assertions_result.errors.length})</div>
                        </div>
                        <div class="test-errors">
                            ${test.assertions_result.errors.map(error => `
                                <div class="test-error-item">
                                    <p>${escapeHtml(error)}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Calculate and update summary statistics
        function updateSummaryStats() {
            if (!reportData) return;
            
            // Calculate all statistics from clusters data
            const criticalClusters = reportData.clusters.filter(c => getClusterSeverity(c) === 'critical').length;
            const highClusters = reportData.clusters.filter(c => getClusterSeverity(c) === 'high').length;
            const totalFixes = reportData.clusters.reduce((sum, c) => sum + c.recommendedFixes.length, 0);
            const totalTests = reportData.clusters.reduce((sum, c) => sum + c.relatedFailedTests.length, 0);
            const totalErrorGroups = reportData.clusters.length;
            
            // Update summary cards
            const criticalEl = document.getElementById('criticalCount');
            const highEl = document.getElementById('highCount');
            const fixesEl = document.getElementById('fixesCount');
            const testsEl = document.getElementById('testsCount');
            
            if (criticalEl) criticalEl.textContent = criticalClusters;
            if (highEl) highEl.textContent = highClusters;
            if (fixesEl) fixesEl.textContent = totalFixes;
            if (testsEl) testsEl.textContent = totalTests;
            
            // Update header badges
            const errorGroupsEl = document.getElementById('errorGroupsCount');
            if (errorGroupsEl) errorGroupsEl.textContent = totalErrorGroups;
            
            const sourceFileEl = document.getElementById('sourceFile');
            if (sourceFileEl && reportData.generatedFrom) {
                sourceFileEl.textContent = reportData.generatedFrom;
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Report data loaded:', reportData.clusters.length, 'clusters');
            updateSummaryStats();
            renderClusters();
        });

    </script>
</body>
</html>